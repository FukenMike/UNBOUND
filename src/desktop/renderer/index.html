<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UNBOUND</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="app" class="app">
    <!-- Menu Bar: Domain-level access and commands -->
    <nav id="menu-bar" class="menu-bar">
      <button class="menu-btn" data-menu="file" title="File operations">File</button>
      <button class="menu-btn" data-menu="project" title="Project and structure">Project</button>
      <button class="menu-btn" data-menu="view" title="View panels and layout">View</button>
      <button class="menu-btn" data-menu="tools" title="Analysis and utilities">Tools</button>
      <div class="project-info">
        <span id="project-title" class="project-title">No project</span>
        <span id="project-stats" class="project-stats">—</span>
      </div>
    </nav>

    <!-- Dropdown Menus (hidden by default) -->
    <div id="file-menu" class="dropdown-menu" style="display:none;">
      <button class="menu-item" data-action="load-project">Load Project</button>
      <button class="menu-item" data-action="ingest-text">Import Text</button>
      <hr />
      <button class="menu-item" data-action="export-json">Export as JSON</button>
      <button class="menu-item" data-action="export-markdown">Export as Markdown</button>
    </div>

    <div id="project-menu" class="dropdown-menu" style="display:none;">
      <button class="menu-item" data-action="add-section">Add Section</button>
      <button class="menu-item" data-action="add-chapter">Add Item</button>
      <hr />
      <button class="menu-item" data-action="view-structure">Structure Panel</button>
    </div>

    <div id="view-menu" class="dropdown-menu" style="display:none;">
      <label class="menu-item checkbox-item">
        <input type="checkbox" id="toggle-structure" checked />
        Structure
      </label>
      <label class="menu-item checkbox-item">
        <input type="checkbox" id="toggle-layout" checked />
        Layout
      </label>
      <label class="menu-item checkbox-item">
        <input type="checkbox" id="toggle-planning" />
        Planning
      </label>
      <label class="menu-item checkbox-item">
        <input type="checkbox" id="toggle-analysis" />
        Analysis
      </label>
      <label class="menu-item checkbox-item">
        <input type="checkbox" id="toggle-revision" />
        Revision
      </label>
    </div>

    <div id="tools-menu" class="dropdown-menu" style="display:none;">
      <button class="menu-item" data-action="text-search">Search in Document</button>
      <button class="menu-item" data-action="word-analysis">Word Analysis</button>
      <hr />
      <button class="menu-item" data-action="settings">Settings</button>
    </div>

    <!-- Left Sidebar: Dockable Panels -->
    <aside id="sidebar-left" class="sidebar sidebar-left">
      <!-- Structure Domain Panel -->
      <div id="panel-structure" class="domain-panel panel-structure" data-domain="structure">
        <div class="panel-header">
          <h2 class="panel-title">Structure</h2>
          <button class="panel-close-btn" data-panel="panel-structure" title="Close">×</button>
        </div>
        <div class="panel-content">
          <div id="structure-tree" class="structure-tree">
            <div class="empty-state">No project loaded</div>
          </div>
        </div>
        <div class="panel-footer">
          <small id="structure-meta">—</small>
        </div>
      </div>
    </aside>

    <!-- Resizer for left sidebar -->
    <div class="resizer resizer-left"></div>

    <!-- Center: Writing Surface (calm, minimal) -->
    <main id="canvas" class="panel panel-canvas">
      <div class="panel-content">
        <!-- Layout Domain: Wrap width controls (optional, dockable, or accessed via Tools) -->
        <div id="layout-toolbar" class="layout-toolbar" style="display: none;">
          <label class="layout-control">
            <span class="layout-label">Width:</span>
            <button class="layout-preset" data-width="600" title="Narrow">N</button>
            <button class="layout-preset" data-width="800" title="Medium">M</button>
            <button class="layout-preset active" data-width="1000" title="Wide">W</button>
            <button class="layout-preset" data-width="0" title="Full">F</button>
          </label>
          <label class="layout-control">
            <span class="layout-label">Line Height:</span>
            <input type="range" id="line-height-slider" min="1.2" max="2.5" step="0.1" value="1.8" />
          </label>
        </div>

        <!-- Writing Surface: Clean, distraction-free editor -->
        <div id="editor-container" class="editor-container">
          <div id="editor-header" class="editor-header" style="display:none;">
            <div class="editor-number" id="editor-number"></div>
            <h1 class="editor-title" id="editor-title"></h1>
          </div>
          <textarea 
            id="editor" 
            class="editor" 
            placeholder="Select an item to begin writing..."
            spellcheck="true"
          ></textarea>
        </div>

        <!-- Empty state: Neutral, no workflow assumptions -->
        <div id="editor-empty" class="canvas-placeholder">
          <div class="placeholder-icon">✦</div>
          <p class="placeholder-text">Select an item to edit</p>
        </div>
      </div>
    </main>

    <!-- Resizer for right sidebar -->
    <div class="resizer resizer-right"></div>

    <!-- Right Sidebar: Dockable Tool Panels -->
    <aside id="sidebar-right" class="sidebar sidebar-right">
      <!-- Layout Domain Panel -->
      <div id="panel-layout" class="domain-panel panel-layout" data-domain="layout" style="display:none;">
        <div class="panel-header">
          <h2 class="panel-title">Layout</h2>
          <button class="panel-close-btn" data-panel="panel-layout" title="Close">×</button>
        </div>
        <div class="panel-content">
          <div class="layout-controls">
            <label class="control-group">
              <span class="control-label">Line Width</span>
              <div class="button-group">
                <button class="layout-preset" data-width="600">Narrow</button>
                <button class="layout-preset" data-width="800">Medium</button>
                <button class="layout-preset active" data-width="1000">Wide</button>
                <button class="layout-preset" data-width="0">Full</button>
              </div>
            </label>
            <label class="control-group">
              <span class="control-label">Line Height</span>
              <input type="range" id="line-height-slider-panel" min="1.2" max="2.5" step="0.1" value="1.8" />
              <span id="line-height-display" class="control-value">1.8</span>
            </label>
            <label class="control-group">
              <span class="control-label">Char Spacing</span>
              <input type="range" id="char-spacing-slider" min="-0.05" max="0.1" step="0.01" value="0" />
              <span id="char-spacing-display" class="control-value">0</span>
            </label>
          </div>
        </div>
      </div>

      <!-- Planning Domain Panel -->
      <div id="panel-planning" class="domain-panel panel-planning" data-domain="planning" style="display:none;">
        <div class="panel-header">
          <h2 class="panel-title">Planning</h2>
          <button class="panel-close-btn" data-panel="panel-planning" title="Close">×</button>
        </div>
        <div class="panel-content">
          <div id="planning-content" class="planning-content">
            <div class="empty-state">No planning content yet</div>
          </div>
        </div>
      </div>

      <!-- Analysis Domain Panel -->
      <div id="panel-analysis" class="domain-panel panel-analysis" data-domain="analysis" style="display:none;">
        <div class="panel-header">
          <h2 class="panel-title">Analysis</h2>
          <button class="panel-close-btn" data-panel="panel-analysis" title="Close">×</button>
        </div>
        <div class="panel-content">
          <div id="analysis-content" class="analysis-content">
            <div class="stat-item">
              <span class="stat-label">Words</span>
              <span id="stat-words" class="stat-value">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Characters</span>
              <span id="stat-chars" class="stat-value">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Paragraphs</span>
              <span id="stat-paragraphs" class="stat-value">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Avg Line</span>
              <span id="stat-avg-line" class="stat-value">0</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Revision Domain Panel -->
      <div id="panel-revision" class="domain-panel panel-revision" data-domain="revision" style="display:none;">
        <div class="panel-header">
          <h2 class="panel-title">Revision</h2>
          <button class="panel-close-btn" data-panel="panel-revision" title="Close">×</button>
        </div>
        <div class="panel-content">
          <div id="revision-content" class="revision-content">
            <div class="empty-state">No revisions loaded</div>
          </div>
        </div>
      </div>
    </aside>
  </div>

  <!-- Load compiled renderer JS from dist (ESM output requires type="module") -->
  <script type="module" src="../../../dist/desktop/renderer/renderer.js"></script>
</body>
</html>
